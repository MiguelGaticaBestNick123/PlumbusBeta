<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>


    <!-- Archivos CSS de Bootstrap -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css">

<!-- Archivos JS de Bootstrap (jQuery y Popper.js) -->

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>

<!-- Archivos CSS personalizados -->
<link rel="stylesheet" href="css/estilo.css">
<link rel="stylesheet" href="css/style-index.css">

<!-- Archivos JS personalizados -->
<script src="js/script-index.js"></script><!-- Archivos JS de Bootstrap (jQuery y Popper.js) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/ruta/a/jquery.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Agregamos los archivos de Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Registro de usuario</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- CSS personalizado -->
    <style>
        body {
        background-image: url('imgs/zyro-image.png');
        background-repeat: no-repeat;
        background-size: cover;
        }
        .card {
        margin-top: 30px;
        }
        .card-header {
            margin-bottom: 1px;
        color: #fff;
        text-align: center;
        font-weight: bold;
        }
        .btn-primary {
        background-color: forestgreen;
        border-color: forestgreen;
        }
        .btn-primary:hover {
        background-color: forestgreen;
        border-color: aforestgreen;
        }
        .error {
        color: #dc3545;
        }
        h1{
            color: white;
        }
        label{
            color: white;
            font-size: large;
        }
        
            
            
            
            
        
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="card" style="background-image: url(imgs/rick-y-morty-portal-dimensional_1920x1080_xtrafondos.com.jpg); background-size: 1300px;">
            <div class="card-header">
            </div>
            <div class="card-body">
                <h1 class="text-center mb-5">Registro de Usuario</h1>
                <!-- Aquí iría el resto del formulario de registro -->

            
        <form method="post" action="index.html" id="procesar" name="procesar">
            <div class="mb-3">
            <label for="nombre" class="form-label">Nombre:</label>
            <input type="text" name="nombre" id="nombre" class="form-control" required>
            </div>
            <div class="mb-3">
            <label for="apellidos" class="form-label">Apellidos:</label>
            <input type="text" name="apellidos" id="apellidos" class="form-control" required>
            </div>
            <div class="mb-3">
            <label for="email" class="form-label">Email:</label>
            <input type="email" name="email" id="email" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="rut" class="form-label">Rut:</label>
                <input type="rut" name="rut" id="rut" class="form-control" required placeholder="formato rut ej: 12.345.678-9 ..">
                
            </div>
            <div class="mb-3">
            <label for="password" class="form-label">Password:</label>
            <input type="password" name="password" id="password" class="form-control" required>
            </div>
            <div class="mb-3">
            <label for="confirm" class="form-label">Confirmar password:</label>
            <input type="password" name="confirm" id="confirm" class="form-control" required>
            </div>
            <div class="d-grid gap-2">
            <button type="submit" id="submit" class="btn btn-primary">Crear Usuario</button>
            </div>
        </form>

        </div>
    
        <script type="text/javascript">
            function validarEmail(email) {
                var re = /\S+@\S+\.\S+/;
                return re.test(email);
            }
            
            function validarRut(rut) {
    var regex = /^(\d{1,3}(\.\d{1,3}){2}-[\dkK])$/;
    if (!regex.test(rut)) return false;
    
    // Eliminar puntos y guión del RUT
    rut = rut.replace(/\./g, '');
    rut = rut.replace('-', '');
    
    // Separar dígito verificador
    var dv = rut.slice(-1);
    rut = rut.slice(0, -1);
    
    // Calcular dígito verificador esperado
    var suma = 0;
    var factor = 2;
    for (var i = rut.length - 1; i >= 0; i--) {
        suma += parseInt(rut.charAt(i)) * factor;
        factor = factor == 7 ? 2 : factor + 1;
    }
    
    var dvEsperado = 11 - (suma % 11);
    dvEsperado = (dvEsperado == 11) ? 0 : ((dvEsperado == 10) ? 'K' : dvEsperado);
    
    return dv == dvEsperado;
}

                
            var form = document.procesar;
            
            document.getElementById("procesar").onsubmit = function(e){
                var ready = false;
            
                if(form.nombre.value != "" && form.apellidos.value != "" && form.email.value != "" && form.rut.value != "" && form.password.value != "" && form.confirm.value != ""){
                    ready = true;
                } else {
                    ready = false;
                    alert("Hay algunos campos vacíos");
                    e.preventDefault();      
                }
            
                if(ready){
                    if(validarEmail(form.email.value)){
                        if(validarRut(form.rut.value)){
                            if(form.password.value == form.confirm.value){
                                ready = true;
                                window.location.href = "index.html"; // redirecciona al index si todo está validado correctamente
                            } else {
                                ready = false;
                                alert("El password y la confirmación no coinciden");
                                form.password.focus();
                                e.preventDefault();
                            }     
                        } else {
                            alert("El RUT ingresado no es válido");
                            form.rut.focus();
                            e.preventDefault();      
                        }
                    } else {
                        alert("El email no tiene un formato válido!");
                        form.email.focus();
                        e.preventDefault();      
                    }
                }
            } 
        </script>
        
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
    
        

</body>
</html>
